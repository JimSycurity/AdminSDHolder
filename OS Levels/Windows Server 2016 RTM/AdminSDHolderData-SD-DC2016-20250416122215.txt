**********************
Windows PowerShell transcript start
Start time: 20250416122216
Username: AD2016\Administrator
RunAs User: AD2016\Administrator
Machine: SD-DC2016 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 4612
PSVersion: 5.1.14393.1884
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.1884
BuildVersion: 10.0.14393.1884
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is C:\Scripts\AdminSDHolderData-SD-DC2016-20250416122215.txt
PS C:\scripts> # Operating System and Platform Enumeration
PS C:\scripts> Write-Host "Hostname: $hostname"
Hostname: SD-DC2016
PS C:\scripts> Write-Host "PSVersion: $($PSVersionTable.PSVersion.ToString())"
PSVersion: 5.1.14393.1884
PS C:\scripts> Write-Host 'Gathering OS and Platform data'
Gathering OS and Platform data
PS C:\scripts> (Get-WmiObject win32_operatingsystem).name
Microsoft Windows Server 2016 Datacenter|C:\Windows|\Device\Harddisk0\Partition4
PS C:\scripts> (Get-WmiObject win32_operatingsystem).OSArchitecture
64-bit
PS C:\scripts> (Get-WmiObject win32_operatingsystem).CSName
SD-DC2016
PS C:\scripts> [Environment]::OSVersion.Platform
Win32NT
PS C:\scripts> [Environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      14393  0


PS C:\scripts> [Environment]::OSVersion.ServicePack

PS C:\scripts> [Environment]::OSVersion.VersionString
Microsoft Windows NT 10.0.14393.0
PS C:\scripts> # Gather Base AD Data
PS C:\scripts> Write-Host 'Gathering base AD data'
Gathering base AD data
PS C:\scripts> $rootDSE = [adsi]"LDAP://rootdse"
PS C:\scripts> $rootDSE | Select-Object -Property *


currentTime                   : {20250416172216.0Z}
subschemaSubentry             : {CN=Aggregate,CN=Schema,CN=Configuration,DC=AD2016,DC=lan}
dsServiceName                 : {CN=NTDS Settings,CN=SD-DC2016,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Config
                                uration,DC=AD2016,DC=lan}
namingContexts                : {DC=AD2016,DC=lan, CN=Configuration,DC=AD2016,DC=lan,
                                CN=Schema,CN=Configuration,DC=AD2016,DC=lan, DC=DomainDnsZones,DC=AD2016,DC=lan...}
defaultNamingContext          : {DC=AD2016,DC=lan}
schemaNamingContext           : {CN=Schema,CN=Configuration,DC=AD2016,DC=lan}
configurationNamingContext    : {CN=Configuration,DC=AD2016,DC=lan}
rootDomainNamingContext       : {DC=AD2016,DC=lan}
supportedControl              : {1.2.840.113556.1.4.319, 1.2.840.113556.1.4.801, 1.2.840.113556.1.4.473,
                                1.2.840.113556.1.4.528...}
supportedLDAPVersion          : {3, 2}
supportedLDAPPolicies         : {MaxPoolThreads, MaxPercentDirSyncRequests, MaxDatagramRecv, MaxReceiveBuffer...}
highestCommittedUSN           : {72936}
supportedSASLMechanisms       : {GSSAPI, GSS-SPNEGO, EXTERNAL, DIGEST-MD5}
dnsHostName                   : {SD-DC2016.AD2016.lan}
ldapServiceName               : {AD2016.lan:sd-dc2016$@AD2016.LAN}
serverName                    : {CN=SD-DC2016,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=AD2016
                                ,DC=lan}
supportedCapabilities         : {1.2.840.113556.1.4.800, 1.2.840.113556.1.4.1670, 1.2.840.113556.1.4.1791,
                                1.2.840.113556.1.4.1935...}
isSynchronized                : {TRUE}
isGlobalCatalogReady          : {TRUE}
domainFunctionality           : {7}
forestFunctionality           : {7}
domainControllerFunctionality : {7}
AuthenticationType            : Secure
Children                      : {}
Guid                          : {228D9A83-C302-11CF-9AA4-00AA004A5691}
ObjectSecurity                :
Name                          : rootdse
NativeGuid                    : {228D9A83-C302-11CF-9AA4-00AA004A5691}
NativeObject                  : System.__ComObject
Parent                        : LDAP:
Password                      :
Path                          : LDAP://rootdse
Properties                    : {currentTime, subschemaSubentry, dsServiceName, namingContexts...}
SchemaClassName               :
SchemaEntry                   :
UsePropertyCache              : True
Username                      :
Options                       : {}
Site                          :
Container                     :



PS C:\scripts> $defaultNC = $rootDSE.defaultNamingContext
PS C:\scripts> $AdminSDHolderDN = "CN=AdminSDHolder,CN=System,$defaultNC"
PS C:\scripts> Write-Host "Legacy Methods"
Legacy Methods
PS C:\scripts> Write-Host "DSACLS:"
DSACLS:
PS C:\scripts> dsacls $AdminSDHolderDN -A
Owner: AD2016\Domain Admins
Group: AD2016\Domain Admins

Audit list:
Success Everyone  SPECIAL ACCESS
                  WRITE PERMISSIONS
                  CHANGE OWNERSHIP
                  WRITE PROPERTY

Permissions inherited to subobjects are:
Inherited to organizationalUnit
Success Everyone  SPECIAL ACCESS for gPOptions   <Inherited from parent>
                  WRITE PROPERTY
Success Everyone  SPECIAL ACCESS for gPLink   <Inherited from parent>
                  WRITE PROPERTY

Access list:
{This object is protected from inheriting permissions from the parent}
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS
                                      READ PERMISSONS
                                      LIST CONTENTS
                                      READ PROPERTY
                                      LIST OBJECT
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS
                                      READ PERMISSONS
                                      LIST CONTENTS
                                      READ PROPERTY
                                      LIST OBJECT
Allow AD2016\Domain Admins            SPECIAL ACCESS
                                      READ PERMISSONS
                                      WRITE PERMISSIONS
                                      CHANGE OWNERSHIP
                                      CREATE CHILD
                                      DELETE CHILD
                                      LIST CONTENTS
                                      WRITE SELF
                                      WRITE PROPERTY
                                      READ PROPERTY
                                      LIST OBJECT
                                      CONTROL ACCESS
Allow AD2016\Enterprise Admins        SPECIAL ACCESS
                                      READ PERMISSONS
                                      WRITE PERMISSIONS
                                      CHANGE OWNERSHIP
                                      CREATE CHILD
                                      DELETE CHILD
                                      LIST CONTENTS
                                      WRITE SELF
                                      WRITE PROPERTY
                                      READ PROPERTY
                                      LIST OBJECT
                                      CONTROL ACCESS
Allow BUILTIN\Administrators          SPECIAL ACCESS
                                      DELETE
                                      READ PERMISSONS
                                      WRITE PERMISSIONS
                                      CHANGE OWNERSHIP
                                      CREATE CHILD
                                      DELETE CHILD
                                      LIST CONTENTS
                                      WRITE SELF
                                      WRITE PROPERTY
                                      READ PROPERTY
                                      LIST OBJECT
                                      CONTROL ACCESS
Allow NT AUTHORITY\Authenticated Users
                                      SPECIAL ACCESS
                                      READ PERMISSONS
                                      LIST CONTENTS
                                      READ PROPERTY
                                      LIST OBJECT
Allow NT AUTHORITY\SYSTEM             FULL CONTROL
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Account Restrictions
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Account Restrictions
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Logon Information
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Logon Information
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Group Membership
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Group Membership
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for General Information
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for General Information
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Remote Access Information
                                      READ PROPERTY
Allow BUILTIN\Pre-Windows 2000 Compatible Access
                                      SPECIAL ACCESS for Remote Access Information
                                      READ PROPERTY
Allow AD2016\Cert Publishers          SPECIAL ACCESS for userCertificate
                                      WRITE PROPERTY
                                      READ PROPERTY
Allow BUILTIN\Windows Authorization Access Group
                                      SPECIAL ACCESS for tokenGroupsGlobalAndUniversal
                                      READ PROPERTY
Allow BUILTIN\Terminal Server License Servers
                                      SPECIAL ACCESS for terminalServer
                                      WRITE PROPERTY
                                      READ PROPERTY
Allow BUILTIN\Terminal Server License Servers
                                      SPECIAL ACCESS for Terminal Server License Server
                                      WRITE PROPERTY
                                      READ PROPERTY
Allow NT AUTHORITY\SELF               SPECIAL ACCESS for Private Information
                                      WRITE PROPERTY
                                      READ PROPERTY
                                      CONTROL ACCESS
Allow Everyone                        Change Password
Allow NT AUTHORITY\SELF               Change Password

Permissions inherited to subobjects are:
Inherited to all subobjects
Allow NT AUTHORITY\SELF               SPECIAL ACCESS for Private Information
                                      WRITE PROPERTY
                                      READ PROPERTY
                                      CONTROL ACCESS

The command completed successfully
PS C:\scripts> $AdminSDHolderDE = [adsi]"LDAP://$AdminSDHolderDN"
PS C:\scripts> $AdminSDHolderDESD = $AdminSDHolderDE.ObjectSecurity
PS C:\scripts> Write-Host "DE SD Type: $($AdminSDHolderDESD.GetType())"
DE SD Type: System.DirectoryServices.ActiveDirectorySecurity
PS C:\scripts> Write-Host "DE Owner: $($AdminSDHolderDESD.Owner)"
DE Owner: AD2016\Domain Admins
PS C:\scripts> Write-Host "DE Group: $($AdminSDHolderDESD.Group)"
DE Group: AD2016\Domain Admins
PS C:\scripts> Write-Host "DE Access:"
DE Access:
PS C:\scripts> $AdminSDHolderDESD.Access


ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\Authenticated Users
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericAll
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SYSTEM
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, Delete, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Administrators
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : AD2016\Domain Admins
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : AD2016\Enterprise Admins
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ExtendedRight
InheritanceType       : None
ObjectType            : ab721a53-1e2f-11d0-9819-00aa0040529b
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : Everyone
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty, ExtendedRight
InheritanceType       : All
ObjectType            : 91e647de-d96f-4b70-9557-d63ff4f3ccd8
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SELF
IsInherited           : False
InheritanceFlags      : ContainerInherit
PropagationFlags      : None

ActiveDirectoryRights : ExtendedRight
InheritanceType       : None
ObjectType            : ab721a53-1e2f-11d0-9819-00aa0040529b
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SELF
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 037088f8-0ae1-11d2-b422-00a0c968f939
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 037088f8-0ae1-11d2-b422-00a0c968f939
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 4c164200-20c0-11d0-a768-00aa006e0529
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 59ba2f42-79a2-11d0-9020-00c04fc2d3cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : bc0ac240-79a9-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : bc0ac240-79a9-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 59ba2f42-79a2-11d0-9020-00c04fc2d3cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 5f202010-79a5-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 4c164200-20c0-11d0-a768-00aa006e0529
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 46a9b11d-60ae-405a-b7e8-ff8a58d456d2
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Windows Authorization Access Group
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : 6db69a1c-9422-11d1-aebd-0000f80367c1
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Terminal Server License Servers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : 5805bc62-bdc9-4428-a5e2-856a0f4c185e
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Terminal Server License Servers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : bf967a7f-0de6-11d0-a285-00aa003049e2
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : AD2016\Cert Publishers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None



PS C:\scripts> Write-Host "DE SDDL:"
DE SDDL:
PS C:\scripts> $AdminSDHolderDESD.SDDL -split "(?=O:)|(?=G:)|(?=D:)|(?=S:)|(?=\()"

O:DA
G:DA
D:PAI
(A;;LCRPLORC;;;AU)
(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)
(A;;CCDCLCSWRPWPLOCRSDRCWDWO;;;BA)
(A;;CCDCLCSWRPWPLOCRRCWDWO;;;DA)
(A;;CCDCLCSWRPWPLOCRRCWDWO;;;S-1-5-21-458780826-1257934750-2189760506-519)
(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)
(OA;CI;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)
(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)
(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)
(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)
(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)
(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)
PS C:\scripts> Write-Host "DE Binary:"
DE Binary:
PS C:\scripts> ([System.BitConverter]::ToString($AdminSDHolderDESD.GetSecurityDescriptorBinaryForm())).Replace('-', '')
0100049C1400000030000000000000004C0000000105000000000005150000009A70581B9E8FFA4AFA178582000200000105000000000005150000009A70581B9E8FFA4AFA178582000200000400380417000000000014009400020001010000000000050B00000000001400FF010F0001010000000000051200000000001800BF010F000102000000000005200000002002000000002400BF010E000105000000000005150000009A70581B9E8FFA4AFA1785820002000000002400BF010E000105000000000005150000009A70581B9E8FFA4AFA17858207020000050028000001000001000000531A72AB2F1ED011981900AA0040529B010100000000000100000000050228003001000001000000DE47E6916FD9704B9557D63FF4F3CCD801010000000000050A000000050028000001000001000000531A72AB2F1ED011981900AA0040529B01010000000000050A00000005003C001000000003000000F8887003E10AD211B42200A0C968F93914CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C001000000003000000F8887003E10AD211B42200A0C968F939BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C0010000000030000000042164CC020D011A76800AA006E0529BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C001000000003000000422FBA59A279D011902000C04FC2D3CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C00100000000300000040C20ABCA979D011902000C04FC2D4CFBA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C00100000000300000040C20ABCA979D011902000C04FC2D4CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C00940002000200000014CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C009400020002000000BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C001000000003000000422FBA59A279D011902000C04FC2D3CFBA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C0010000000030000001020205FA579D011902000C04FC2D4CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C0010000000030000000042164CC020D011A76800AA006E052914CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C0010000000010000001DB1A946AE605A40B7E8FF8A58D456D20102000000000005200000003002000005002C0030000000010000001C9AB66D2294D111AEBD0000F80367C10102000000000005200000003102000005002C00300000000100000062BC0558C9BD2844A5E2856A0F4C185E010200000000000520000000310200000500380030000000010000007F7A96BFE60DD011A28500AA003049E20105000000000005150000009A70581B9E8FFA4AFA17858205020000
PS C:\scripts> Write-Host "Modern Module Methods"
Modern Module Methods
PS C:\scripts> $AdminSDHolderObject = Get-ADObject $AdminSDHolderDN -Properties *
PS C:\scripts> $AdminSDHolderSD = $AdminSDHolderObject.nTSecurityDescriptor
PS C:\scripts> Write-Host "ADO SD Type: $($AdminSDHolderSD.GetType())"
ADO SD Type: System.DirectoryServices.ActiveDirectorySecurity
PS C:\scripts> Write-Host "ADO Owner: $($AdminSDHolderSD.Owner)"
ADO Owner: AD2016\Domain Admins
PS C:\scripts> Write-Host "ADO Group: $($AdminSDHolderSD.Group)"
ADO Group: AD2016\Domain Admins
PS C:\scripts> Write-Host "ADO Access:"
ADO Access:
PS C:\scripts> $AdminSDHolderSD.Access


ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\Authenticated Users
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericAll
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SYSTEM
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, Delete, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Administrators
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : AD2016\Domain Admins
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, GenericRead, WriteDacl,
                        WriteOwner
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : AD2016\Enterprise Admins
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ExtendedRight
InheritanceType       : None
ObjectType            : ab721a53-1e2f-11d0-9819-00aa0040529b
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : Everyone
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty, ExtendedRight
InheritanceType       : All
ObjectType            : 91e647de-d96f-4b70-9557-d63ff4f3ccd8
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SELF
IsInherited           : False
InheritanceFlags      : ContainerInherit
PropagationFlags      : None

ActiveDirectoryRights : ExtendedRight
InheritanceType       : None
ObjectType            : ab721a53-1e2f-11d0-9819-00aa0040529b
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : NT AUTHORITY\SELF
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 037088f8-0ae1-11d2-b422-00a0c968f939
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 037088f8-0ae1-11d2-b422-00a0c968f939
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 4c164200-20c0-11d0-a768-00aa006e0529
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 59ba2f42-79a2-11d0-9020-00c04fc2d3cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : bc0ac240-79a9-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : bc0ac240-79a9-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : GenericRead
InheritanceType       : None
ObjectType            : 00000000-0000-0000-0000-000000000000
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : None
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 59ba2f42-79a2-11d0-9020-00c04fc2d3cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 5f202010-79a5-11d0-9020-00c04fc2d4cf
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 4c164200-20c0-11d0-a768-00aa006e0529
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Pre-Windows 2000 Compatible Access
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty
InheritanceType       : None
ObjectType            : 46a9b11d-60ae-405a-b7e8-ff8a58d456d2
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Windows Authorization Access Group
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : 6db69a1c-9422-11d1-aebd-0000f80367c1
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Terminal Server License Servers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : 5805bc62-bdc9-4428-a5e2-856a0f4c185e
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : BUILTIN\Terminal Server License Servers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None

ActiveDirectoryRights : ReadProperty, WriteProperty
InheritanceType       : None
ObjectType            : bf967a7f-0de6-11d0-a285-00aa003049e2
InheritedObjectType   : 00000000-0000-0000-0000-000000000000
ObjectFlags           : ObjectAceTypePresent
AccessControlType     : Allow
IdentityReference     : AD2016\Cert Publishers
IsInherited           : False
InheritanceFlags      : None
PropagationFlags      : None



PS C:\scripts> Write-Host "ADO SDDL:" -split "(?=O:)|(?=G:)|(?=D:)|(?=S:)|(?=\()"
ADO SDDL: -split (?=O:)|(?=G:)|(?=D:)|(?=S:)|(?=\()
PS C:\scripts> $AdminSDHolderSD.SDDL
O:DAG:DAD:PAI(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCDCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPLOCRRCWDWO;;;DA)(A;;CCDCLCSWRPWPLOCRRCWDWO;;;S-1-5-21-458780826-1257934750-2189760506-519)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OA;CI;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)
PS C:\scripts> Write-Host "ADO Binary:"
ADO Binary:
PS C:\scripts> ([System.BitConverter]::ToString($AdminSDHolderSD.GetSecurityDescriptorBinaryForm())).Replace('-', '')
0100049C1400000030000000000000004C0000000105000000000005150000009A70581B9E8FFA4AFA178582000200000105000000000005150000009A70581B9E8FFA4AFA178582000200000400380417000000000014009400020001010000000000050B00000000001400FF010F0001010000000000051200000000001800BF010F000102000000000005200000002002000000002400BF010E000105000000000005150000009A70581B9E8FFA4AFA1785820002000000002400BF010E000105000000000005150000009A70581B9E8FFA4AFA17858207020000050028000001000001000000531A72AB2F1ED011981900AA0040529B010100000000000100000000050228003001000001000000DE47E6916FD9704B9557D63FF4F3CCD801010000000000050A000000050028000001000001000000531A72AB2F1ED011981900AA0040529B01010000000000050A00000005003C001000000003000000F8887003E10AD211B42200A0C968F93914CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C001000000003000000F8887003E10AD211B42200A0C968F939BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C0010000000030000000042164CC020D011A76800AA006E0529BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C001000000003000000422FBA59A279D011902000C04FC2D3CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C00100000000300000040C20ABCA979D011902000C04FC2D4CFBA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C00100000000300000040C20ABCA979D011902000C04FC2D4CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C00940002000200000014CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C009400020002000000BA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C001000000003000000422FBA59A279D011902000C04FC2D3CFBA7A96BFE60DD011A28500AA003049E20102000000000005200000002A02000005003C0010000000030000001020205FA579D011902000C04FC2D4CF14CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005003C0010000000030000000042164CC020D011A76800AA006E052914CC28483714BC459B07AD6F015E5F280102000000000005200000002A02000005002C0010000000010000001DB1A946AE605A40B7E8FF8A58D456D20102000000000005200000003002000005002C0030000000010000001C9AB66D2294D111AEBD0000F80367C10102000000000005200000003102000005002C00300000000100000062BC0558C9BD2844A5E2856A0F4C185E010200000000000520000000310200000500380030000000010000007F7A96BFE60DD011A28500AA003049E20105000000000005150000009A70581B9E8FFA4AFA17858205020000
PS C:\scripts> # NTObjectManager
PS C:\scripts> $AdminSDHolderNTSD = $AdminSDHolderSD | ConvertTo-NtSecurityDescriptor
PS C:\scripts> Write-Host "NTSD Type: $($AdminSDHolderNTSD.GetType())"
NTSD Type: NtCoreLib.Security.Authorization.SecurityDescriptor
PS C:\scripts> Write-Host "NTSD Self Relative:"
NTSD Self Relative:
PS C:\scripts> $AdminSDHolderNTSD.SelfRelative
True
PS C:\scripts> Write-Host "NTSD Owner:"
NTSD Owner:
PS C:\scripts> $AdminSDHolderNTSD.Owner

Sid                                          Defaulted
---                                          ---------
S-1-5-21-458780826-1257934750-2189760506-512     False


PS C:\scripts> Write-Host "NTSD Group:"
NTSD Group:
PS C:\scripts> $AdminSDHolderNTSD.Group

Sid                                          Defaulted
---                                          ---------
S-1-5-21-458780826-1257934750-2189760506-512     False


PS C:\scripts> Write-Host "NTSD Control:"
NTSD Control:
PS C:\scripts> $AdminSDHolderNTSD.Control
DaclPresent, DaclAutoInherited, DaclProtected
PS C:\scripts> Write-Host "NTSD Container:"
NTSD Container:
PS C:\scripts> $AdminSDHolderNTSD.Container
True
PS C:\scripts> Write-Host "NTSD AccessRightsType:"
NTSD AccessRightsType:
PS C:\scripts> $AdminSDHolderNTSD.AccessRightsType

IsPublic IsSerial Name                                     BaseType
-------- -------- ----                                     --------
True     True     DirectoryServiceAccessRights             System.Enum


PS C:\scripts> Write-Host "NTSD DACL Canonical:"
NTSD DACL Canonical:
PS C:\scripts> $AdminSDHolderNTSD.DaclCanonical
True
PS C:\scripts> Write-Host "NTSD DACL Defaulted:"
NTSD DACL Defaulted:
PS C:\scripts> $AdminSDHolderNTSD.DaclDefaulted
False
PS C:\scripts> Write-Host "NTSD DACL:"
NTSD DACL:
PS C:\scripts> $AdminSDHolderNTSD.Dacl

Type          User                                       Flags            Mask
----          ----                                       -----            ----
Allowed       NT AUTHORITY\Authenticated Users           None             00020094
Allowed       NT AUTHORITY\SYSTEM                        None             000F01FF
Allowed       BUILTIN\Administrators                     None             000F01BF
Allowed       AD2016\Domain Admins                       None             000E01BF
Allowed       AD2016\Enterprise Admins                   None             000E01BF
AllowedObject Everyone                                   None             00000100
AllowedObject NT AUTHORITY\SELF                          ContainerInherit 00000130
AllowedObject NT AUTHORITY\SELF                          None             00000100
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00020094
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00020094
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Pre-Windows 2000 Compatible Access None             00000010
AllowedObject BUILTIN\Windows Authorization Access Group None             00000010
AllowedObject BUILTIN\Terminal Server License Servers    None             00000030
AllowedObject BUILTIN\Terminal Server License Servers    None             00000030
AllowedObject AD2016\Cert Publishers                     None             00000030


PS C:\scripts> Write-Host "NTSD Self-Relative Hex:"
NTSD Self-Relative Hex:
PS C:\scripts> $ba = ConvertFrom-NtSecurityDescriptor $AdminSDHolderNTSD
PS C:\scripts> $ba | Out-HexDump -ShowAll
          00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F  - 0123456789ABCDEF
-----------------------------------------------------------------------------
00000000: 01 00 04 94 4C 04 00 00 68 04 00 00 00 00 00 00  - ....L...h.......
00000010: 14 00 00 00 04 00 38 04 17 00 00 00 00 00 14 00  - ......8.........
00000020: 94 00 02 00 01 01 00 00 00 00 00 05 0B 00 00 00  - ................
00000030: 00 00 14 00 FF 01 0F 00 01 01 00 00 00 00 00 05  - ................
00000040: 12 00 00 00 00 00 18 00 BF 01 0F 00 01 02 00 00  - ................
00000050: 00 00 00 05 20 00 00 00 20 02 00 00 00 00 24 00  - .... ... .....$.
00000060: BF 01 0E 00 01 05 00 00 00 00 00 05 15 00 00 00  - ................
00000070: 9A 70 58 1B 9E 8F FA 4A FA 17 85 82 00 02 00 00  - .pX....J........
00000080: 00 00 24 00 BF 01 0E 00 01 05 00 00 00 00 00 05  - ..$.............
00000090: 15 00 00 00 9A 70 58 1B 9E 8F FA 4A FA 17 85 82  - .....pX....J....
000000A0: 07 02 00 00 05 00 28 00 00 01 00 00 01 00 00 00  - ......(.........
000000B0: 53 1A 72 AB 2F 1E D0 11 98 19 00 AA 00 40 52 9B  - S.r./........@R.
000000C0: 01 01 00 00 00 00 00 01 00 00 00 00 05 02 28 00  - ..............(.
000000D0: 30 01 00 00 01 00 00 00 DE 47 E6 91 6F D9 70 4B  - 0........G..o.pK
000000E0: 95 57 D6 3F F4 F3 CC D8 01 01 00 00 00 00 00 05  - .W.?............
000000F0: 0A 00 00 00 05 00 28 00 00 01 00 00 01 00 00 00  - ......(.........
00000100: 53 1A 72 AB 2F 1E D0 11 98 19 00 AA 00 40 52 9B  - S.r./........@R.
00000110: 01 01 00 00 00 00 00 05 0A 00 00 00 05 00 3C 00  - ..............<.
00000120: 10 00 00 00 03 00 00 00 F8 88 70 03 E1 0A D2 11  - ..........p.....
00000130: B4 22 00 A0 C9 68 F9 39 14 CC 28 48 37 14 BC 45  - ."...h.9..(H7..E
00000140: 9B 07 AD 6F 01 5E 5F 28 01 02 00 00 00 00 00 05  - ...o.^_(........
00000150: 20 00 00 00 2A 02 00 00 05 00 3C 00 10 00 00 00  -  ...*.....<.....
00000160: 03 00 00 00 F8 88 70 03 E1 0A D2 11 B4 22 00 A0  - ......p......"..
00000170: C9 68 F9 39 BA 7A 96 BF E6 0D D0 11 A2 85 00 AA  - .h.9.z..........
00000180: 00 30 49 E2 01 02 00 00 00 00 00 05 20 00 00 00  - .0I......... ...
00000190: 2A 02 00 00 05 00 3C 00 10 00 00 00 03 00 00 00  - *.....<.........
000001A0: 00 42 16 4C C0 20 D0 11 A7 68 00 AA 00 6E 05 29  - .B.L. ...h...n.)
000001B0: BA 7A 96 BF E6 0D D0 11 A2 85 00 AA 00 30 49 E2  - .z...........0I.
000001C0: 01 02 00 00 00 00 00 05 20 00 00 00 2A 02 00 00  - ........ ...*...
000001D0: 05 00 3C 00 10 00 00 00 03 00 00 00 42 2F BA 59  - ..<.........B/.Y
000001E0: A2 79 D0 11 90 20 00 C0 4F C2 D3 CF 14 CC 28 48  - .y... ..O.....(H
000001F0: 37 14 BC 45 9B 07 AD 6F 01 5E 5F 28 01 02 00 00  - 7..E...o.^_(....
00000200: 00 00 00 05 20 00 00 00 2A 02 00 00 05 00 3C 00  - .... ...*.....<.
00000210: 10 00 00 00 03 00 00 00 40 C2 0A BC A9 79 D0 11  - ........@....y..
00000220: 90 20 00 C0 4F C2 D4 CF BA 7A 96 BF E6 0D D0 11  - . ..O....z......
00000230: A2 85 00 AA 00 30 49 E2 01 02 00 00 00 00 00 05  - .....0I.........
00000240: 20 00 00 00 2A 02 00 00 05 00 3C 00 10 00 00 00  -  ...*.....<.....
00000250: 03 00 00 00 40 C2 0A BC A9 79 D0 11 90 20 00 C0  - ....@....y... ..
00000260: 4F C2 D4 CF 14 CC 28 48 37 14 BC 45 9B 07 AD 6F  - O.....(H7..E...o
00000270: 01 5E 5F 28 01 02 00 00 00 00 00 05 20 00 00 00  - .^_(........ ...
00000280: 2A 02 00 00 05 00 2C 00 94 00 02 00 02 00 00 00  - *.....,.........
00000290: 14 CC 28 48 37 14 BC 45 9B 07 AD 6F 01 5E 5F 28  - ..(H7..E...o.^_(
000002A0: 01 02 00 00 00 00 00 05 20 00 00 00 2A 02 00 00  - ........ ...*...
000002B0: 05 00 2C 00 94 00 02 00 02 00 00 00 BA 7A 96 BF  - ..,..........z..
000002C0: E6 0D D0 11 A2 85 00 AA 00 30 49 E2 01 02 00 00  - .........0I.....
000002D0: 00 00 00 05 20 00 00 00 2A 02 00 00 05 00 3C 00  - .... ...*.....<.
000002E0: 10 00 00 00 03 00 00 00 42 2F BA 59 A2 79 D0 11  - ........B/.Y.y..
000002F0: 90 20 00 C0 4F C2 D3 CF BA 7A 96 BF E6 0D D0 11  - . ..O....z......
00000300: A2 85 00 AA 00 30 49 E2 01 02 00 00 00 00 00 05  - .....0I.........
00000310: 20 00 00 00 2A 02 00 00 05 00 3C 00 10 00 00 00  -  ...*.....<.....
00000320: 03 00 00 00 10 20 20 5F A5 79 D0 11 90 20 00 C0  - .....  _.y... ..
00000330: 4F C2 D4 CF 14 CC 28 48 37 14 BC 45 9B 07 AD 6F  - O.....(H7..E...o
00000340: 01 5E 5F 28 01 02 00 00 00 00 00 05 20 00 00 00  - .^_(........ ...
00000350: 2A 02 00 00 05 00 3C 00 10 00 00 00 03 00 00 00  - *.....<.........
00000360: 00 42 16 4C C0 20 D0 11 A7 68 00 AA 00 6E 05 29  - .B.L. ...h...n.)
00000370: 14 CC 28 48 37 14 BC 45 9B 07 AD 6F 01 5E 5F 28  - ..(H7..E...o.^_(
00000380: 01 02 00 00 00 00 00 05 20 00 00 00 2A 02 00 00  - ........ ...*...
00000390: 05 00 2C 00 10 00 00 00 01 00 00 00 1D B1 A9 46  - ..,............F
000003A0: AE 60 5A 40 B7 E8 FF 8A 58 D4 56 D2 01 02 00 00  - .`Z@....X.V.....
000003B0: 00 00 00 05 20 00 00 00 30 02 00 00 05 00 2C 00  - .... ...0.....,.
000003C0: 30 00 00 00 01 00 00 00 1C 9A B6 6D 22 94 D1 11  - 0..........m"...
000003D0: AE BD 00 00 F8 03 67 C1 01 02 00 00 00 00 00 05  - ......g.........
000003E0: 20 00 00 00 31 02 00 00 05 00 2C 00 30 00 00 00  -  ...1.....,.0...
000003F0: 01 00 00 00 62 BC 05 58 C9 BD 28 44 A5 E2 85 6A  - ....b..X..(D...j
00000400: 0F 4C 18 5E 01 02 00 00 00 00 00 05 20 00 00 00  - .L.^........ ...
00000410: 31 02 00 00 05 00 38 00 30 00 00 00 01 00 00 00  - 1.....8.0.......
00000420: 7F 7A 96 BF E6 0D D0 11 A2 85 00 AA 00 30 49 E2  - .z...........0I.
00000430: 01 05 00 00 00 00 00 05 15 00 00 00 9A 70 58 1B  - .............pX.
00000440: 9E 8F FA 4A FA 17 85 82 05 02 00 00 01 05 00 00  - ...J............
00000450: 00 00 00 05 15 00 00 00 9A 70 58 1B 9E 8F FA 4A  - .........pX....J
00000460: FA 17 85 82 00 02 00 00 01 05 00 00 00 00 00 05  - ................
00000470: 15 00 00 00 9A 70 58 1B 9E 8F FA 4A FA 17 85 82  - .....pX....J....
00000480: 00 02 00 00                                      - ....
PS C:\scripts> Write-Host "Base64:"
Base64:
PS C:\scripts> $AdminSDHolderNTSD.ToBase64(1)
AQAElEwEAABoBAAAAAAAABQAAAAEADgEFwAAAAAAFACUAAIAAQEAAAAAAAULAAAAAAAUAP8BDwAB
AQAAAAAABRIAAAAAABgAvwEPAAECAAAAAAAFIAAAACACAAAAACQAvwEOAAEFAAAAAAAFFQAAAJpw
WBuej/pK+heFggACAAAAACQAvwEOAAEFAAAAAAAFFQAAAJpwWBuej/pK+heFggcCAAAFACgAAAEA
AAEAAABTGnKrLx7QEZgZAKoAQFKbAQEAAAAAAAEAAAAABQIoADABAAABAAAA3kfmkW/ZcEuVV9Y/
9PPM2AEBAAAAAAAFCgAAAAUAKAAAAQAAAQAAAFMacqsvHtARmBkAqgBAUpsBAQAAAAAABQoAAAAF
ADwAEAAAAAMAAAD4iHAD4QrSEbQiAKDJaPk5FMwoSDcUvEWbB61vAV5fKAECAAAAAAAFIAAAACoC
AAAFADwAEAAAAAMAAAD4iHAD4QrSEbQiAKDJaPk5unqWv+YN0BGihQCqADBJ4gECAAAAAAAFIAAA
ACoCAAAFADwAEAAAAAMAAAAAQhZMwCDQEadoAKoAbgUpunqWv+YN0BGihQCqADBJ4gECAAAAAAAF
IAAAACoCAAAFADwAEAAAAAMAAABCL7pZonnQEZAgAMBPwtPPFMwoSDcUvEWbB61vAV5fKAECAAAA
AAAFIAAAACoCAAAFADwAEAAAAAMAAABAwgq8qXnQEZAgAMBPwtTPunqWv+YN0BGihQCqADBJ4gEC
AAAAAAAFIAAAACoCAAAFADwAEAAAAAMAAABAwgq8qXnQEZAgAMBPwtTPFMwoSDcUvEWbB61vAV5f
KAECAAAAAAAFIAAAACoCAAAFACwAlAACAAIAAAAUzChINxS8RZsHrW8BXl8oAQIAAAAAAAUgAAAA
KgIAAAUALACUAAIAAgAAALp6lr/mDdARooUAqgAwSeIBAgAAAAAABSAAAAAqAgAABQA8ABAAAAAD
AAAAQi+6WaJ50BGQIADAT8LTz7p6lr/mDdARooUAqgAwSeIBAgAAAAAABSAAAAAqAgAABQA8ABAA
AAADAAAAECAgX6V50BGQIADAT8LUzxTMKEg3FLxFmwetbwFeXygBAgAAAAAABSAAAAAqAgAABQA8
ABAAAAADAAAAAEIWTMAg0BGnaACqAG4FKRTMKEg3FLxFmwetbwFeXygBAgAAAAAABSAAAAAqAgAA
BQAsABAAAAABAAAAHbGpRq5gWkC36P+KWNRW0gECAAAAAAAFIAAAADACAAAFACwAMAAAAAEAAAAc
mrZtIpTREa69AAD4A2fBAQIAAAAAAAUgAAAAMQIAAAUALAAwAAAAAQAAAGK8BVjJvShEpeKFag9M
GF4BAgAAAAAABSAAAAAxAgAABQA4ADAAAAABAAAAf3qWv+YN0BGihQCqADBJ4gEFAAAAAAAFFQAA
AJpwWBuej/pK+heFggUCAAABBQAAAAAABRUAAACacFgbno/6SvoXhYIAAgAAAQUAAAAAAAUVAAAA
mnBYG56P+kr6F4WCAAIAAA==
PS C:\scripts> Write-Host "HashCode:"
HashCode:
PS C:\scripts> $AdminSDHolderNTSD.GetHashCode()
12395348
PS C:\scripts> Write-Host "NTSD SDDL:"
NTSD SDDL:
PS C:\scripts> $AdminSDHolderNTSD.ToSDDL() -split "(?=O:)|(?=G:)|(?=D:)|(?=S:)|(?=\()"

O:DA
G:DA
D:PAI
(A;;LCRPLORC;;;AU)
(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)
(A;;CCDCLCSWRPWPLOCRSDRCWDWO;;;BA)
(A;;CCDCLCSWRPWPLOCRRCWDWO;;;DA)
(A;;CCDCLCSWRPWPLOCRRCWDWO;;;S-1-5-21-458780826-1257934750-2189760506-519)
(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)
(OA;CI;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)
(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)
(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)
(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)
(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)
(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)
(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)
(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)
PS C:\scripts> Write-Host "Win32SD:"
Win32SD:
PS C:\scripts> Format-Win32SecurityDescriptor -Name $AdminSDHolderDN -Type DsAll -ShowAll -ResolveObjectType
Path: CN=AdminSDHolder,CN=System,DC=AD2016,DC=lan
Type: DirectoryService
Control: DaclPresent, DaclAutoInherited, DaclProtected

<Owner>
 - Name  : AD2016\Domain Admins
 - Sid   : S-1-5-21-458780826-1257934750-2189760506-512

<Group>
 - Name  : AD2016\Domain Admins
 - Sid   : S-1-5-21-458780826-1257934750-2189760506-512

<DACL> (Protected, Auto Inherited)
 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: User-Account-Restrictions
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: User-Account-Restrictions
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: User-Logon
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: User-Logon
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: Membership
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: Membership
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: General-Information
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: General-Information
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: RAS-Information
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: RAS-Information
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : AD2016\Cert Publishers
 - SID   : S-1-5-21-458780826-1257934750-2189760506-517
 - Mask  : 0x00000030
 - Access: ReadProp|WriteProp
 - Flags : None
 - ObjectType: X509-Cert

 - Type  : AllowedObject
 - Name  : BUILTIN\Windows Authorization Access Group
 - SID   : S-1-5-32-560
 - Mask  : 0x00000010
 - Access: ReadProp
 - Flags : None
 - ObjectType: Token-Groups-Global-And-Universal

 - Type  : AllowedObject
 - Name  : BUILTIN\Terminal Server License Servers
 - SID   : S-1-5-32-561
 - Mask  : 0x00000030
 - Access: ReadProp|WriteProp
 - Flags : None
 - ObjectType: Terminal-Server

 - Type  : AllowedObject
 - Name  : BUILTIN\Terminal Server License Servers
 - SID   : S-1-5-32-561
 - Mask  : 0x00000030
 - Access: ReadProp|WriteProp
 - Flags : None
 - ObjectType: Terminal-Server-License-Server

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00020094
 - Access: List|ReadProp|ListObject|ReadControl
 - Flags : None
 - InheritedObjectType: inetOrgPerson

 - Type  : AllowedObject
 - Name  : BUILTIN\Pre-Windows 2000 Compatible Access
 - SID   : S-1-5-32-554
 - Mask  : 0x00020094
 - Access: List|ReadProp|ListObject|ReadControl
 - Flags : None
 - InheritedObjectType: User

 - Type  : AllowedObject
 - Name  : Everyone
 - SID   : S-1-1-0
 - Mask  : 0x00000100
 - Access: ControlAccess
 - Flags : None
 - ObjectType: User-Change-Password

 - Type  : AllowedObject
 - Name  : NT AUTHORITY\SELF
 - SID   : S-1-5-10
 - Mask  : 0x00000100
 - Access: ControlAccess
 - Flags : None
 - ObjectType: User-Change-Password

 - Type  : AllowedObject
 - Name  : NT AUTHORITY\SELF
 - SID   : S-1-5-10
 - Mask  : 0x00000130
 - Access: ReadProp|WriteProp|ControlAccess
 - Flags : ContainerInherit
 - ObjectType: Private-Information

 - Type  : Allowed
 - Name  : AD2016\Domain Admins
 - SID   : S-1-5-21-458780826-1257934750-2189760506-512
 - Mask  : 0x000E01BF
 - Access: CreateChild|DeleteChild|List|Self|ReadProp|WriteProp|ListObject|ControlAccess|ReadControl|WriteDac|WriteOwner
 - Flags : None

 - Type  : Allowed
 - Name  : AD2016\Enterprise Admins
 - SID   : S-1-5-21-458780826-1257934750-2189760506-519
 - Mask  : 0x000E01BF
 - Access: CreateChild|DeleteChild|List|Self|ReadProp|WriteProp|ListObject|ControlAccess|ReadControl|WriteDac|WriteOwner
 - Flags : None

 - Type  : Allowed
 - Name  : BUILTIN\Administrators
 - SID   : S-1-5-32-544
 - Mask  : 0x000F01BF
 - Access: CreateChild|DeleteChild|List|Self|ReadProp|WriteProp|ListObject|ControlAccess|Delete|ReadControl|WriteDac|WriteOwner
 - Flags : None

 - Type  : Allowed
 - Name  : NT AUTHORITY\Authenticated Users
 - SID   : S-1-5-11
 - Mask  : 0x00020094
 - Access: List|ReadProp|ListObject|ReadControl
 - Flags : None

 - Type  : Allowed
 - Name  : NT AUTHORITY\SYSTEM
 - SID   : S-1-5-18
 - Mask  : 0x000F01FF
 - Access: Full Access
 - Flags : None

PS C:\scripts> Write-Host "Win32SD Inherited ACEs:"
Win32SD Inherited ACEs:
PS C:\scripts> $cls = Get-DsObjectSchemaClass -DistinguishedName $AdminSDHolderDN
PS C:\scripts> Search-Win32SecurityDescriptor -Name $AdminSDHolderDN -Type Ds -ObjectType $cls.SchemaID

Name Depth User                                       Access
---- ----- ----                                       ------
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access ReadProp
     0     AD2016\Cert Publishers                     ReadProp|WriteProp
     0     BUILTIN\Windows Authorization Access Group ReadProp
     0     BUILTIN\Terminal Server License Servers    ReadProp|WriteProp
     0     BUILTIN\Terminal Server License Servers    ReadProp|WriteProp
     0     BUILTIN\Pre-Windows 2000 Compatible Access GenericRead
     0     BUILTIN\Pre-Windows 2000 Compatible Access GenericRead
     0     Everyone                                   ControlAccess
     0     NT AUTHORITY\SELF                          ControlAccess
     0     NT AUTHORITY\SELF                          ReadProp|WriteProp|ControlAccess
     0     AD2016\Domain Admins                       CreateChild|DeleteChild|ControlAccess|WriteDac|WriteOwner|Gene...
     0     AD2016\Enterprise Admins                   CreateChild|DeleteChild|ControlAccess|WriteDac|WriteOwner|Gene...
     0     BUILTIN\Administrators                     CreateChild|DeleteChild|ControlAccess|Delete|WriteDac|WriteOwn...
     0     NT AUTHORITY\Authenticated Users           GenericRead
     0     NT AUTHORITY\SYSTEM                        GenericAll


PS C:\scripts> Stop-Transcript
**********************
Windows PowerShell transcript end
End time: 20250416122218
**********************
